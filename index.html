<!DOCTYPE html>
<html>
<head>
    <title>Youssef & Ameni Game</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>

    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        body{
            font-family:Arial,sans-serif;
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            min-height:100vh;
            display:flex;
            justify-content:center;
            align-items:center;
            padding:15px;
        }
        .game-box{
            background:white;
            border-radius:20px;
            padding:25px;
            width:100%;
            max-width:400px;
            box-shadow:0 10px 40px rgba(0,0,0,0.2);
        }
        h1{text-align:center;margin-bottom:20px;color:#333;}
        .player-btn{
            width:100%;
            padding:20px;
            margin:10px 0;
            font-size:22px;
            font-weight:bold;
            border:none;
            border-radius:15px;
            cursor:pointer;
            color:white;
        }
        .youssef{background:#2196F3;}
        .ameni{background:#E91E63;}
        .section{
            background:#f8f9fa;
            border:2px solid #ddd;
            border-radius:15px;
            padding:20px;
            margin:15px 0;
        }
        input{
            width:100%;
            padding:15px;
            font-size:20px;
            text-align:center;
            border:2px solid #ddd;
            border-radius:10px;
            margin:10px 0;
            outline:none;
        }
        input:focus{border-color:#667eea;}
        button{
            width:100%;
            padding:15px;
            background:#4CAF50;
            color:white;
            border:none;
            border-radius:10px;
            font-size:18px;
            font-weight:bold;
            cursor:pointer;
            margin:5px 0;
        }
        button:disabled{background:#ccc;cursor:not-allowed;}
        .waiting{
            background:#fff3cd;
            color:#856404;
            padding:30px;
            border-radius:15px;
            text-align:center;
            margin:20px 0;
        }
        .turn-box{
            background:#e8f5e9;
            padding:15px;
            border-radius:10px;
            margin:15px 0;
            font-weight:bold;
            text-align:center;
        }
        .hidden{display:none;}
        .status{color:#4CAF50;text-align:center;margin:10px 0;}
    </style>
</head>

<body>

<div class="game-box">
    <h1>üéÆ YOUSSEF ü§ù AMENI</h1>

    <div id="playerScreen">
        <div class="section">
            <h3>WHO ARE YOU?</h3>
            <button class="player-btn youssef" onclick="setPlayer('youssef')">YOUSSEF</button>
            <button class="player-btn ameni" onclick="setPlayer('ameni')">AMENI</button>
        </div>
    </div>

    <div id="gameScreen" class="hidden">
        <div id="lockSection" class="section">
            <h3 id="playerName"></h3>
            <p>Choose your secret number (1-100)</p>
            <input type="number" id="secretNumber" min="1" max="100">
            <button onclick="lockNumber()">LOCK NUMBER</button>
        </div>

        <div id="waitingSection" class="waiting hidden">
            Waiting for other player...
        </div>

        <div id="playSection" class="hidden">
            <div class="turn-box" id="turnDisplay"></div>

            <div class="section">
                <h3 id="guessTitle"></h3>
                <input type="number" id="guessNumber" min="1" max="100">
                <button onclick="makeGuess()" id="guessBtn" disabled>GUESS</button>
            </div>

            <div id="hintDisplay" class="waiting hidden"></div>
        </div>
    </div>

    <div id="winnerDisplay" class="waiting hidden"></div>
    <div id="connectionStatus" class="status"></div>

    <button onclick="resetGame()" style="background:#f44336;margin-top:20px;">
        NEW GAME
    </button>
</div>

<script>

const firebaseConfig = {
    apiKey:"YOUR_API_KEY",
    authDomain:"YOUR_DOMAIN",
    databaseURL:"YOUR_DB_URL",
    projectId:"YOUR_PROJECT_ID"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

const gameRef = database.ref("games/game123");

let currentPlayer=null;

database.ref(".info/connected").on("value",(snap)=>{
    document.getElementById("connectionStatus").innerHTML =
        snap.val() ? "Connected" : "Connecting...";
});

gameRef.on("value",(snapshot)=>{
    const game=snapshot.val();
    if(game) updateUI(game);
});

function setPlayer(player){
    currentPlayer=player;
    document.getElementById("playerScreen").classList.add("hidden");
    document.getElementById("gameScreen").classList.remove("hidden");
    document.getElementById("playerName").innerHTML=
        player==="youssef"?"Youssef":"Ameni";

    gameRef.once("value",(snap)=>{
        if(!snap.val()){
            gameRef.set({
                youssef:{locked:false,number:null},
                ameni:{locked:false,number:null},
                turn:"youssef",
                winner:null,
                guesses:[]
            });
        }
    });
}

function lockNumber(){
    const num=parseInt(document.getElementById("secretNumber").value);
    if(num<1||num>100) return alert("Number must be 1-100");

    let updates={};
    updates[currentPlayer+"/locked"]=true;
    updates[currentPlayer+"/number"]=num;

    gameRef.update(updates);
}

function makeGuess(){
    const guess=parseInt(document.getElementById("guessNumber").value);
    if(guess<1||guess>100) return alert("Number must be 1-100");

    gameRef.once("value",(snap)=>{
        const game=snap.val();
        if(game.winner) return;

        const other=currentPlayer==="youssef"?"ameni":"youssef";
        const target=game[other].number;

        let updates={};
        let guesses=game.guesses||[];

        guesses.push({
            player:currentPlayer,
            guess:guess,
            time:Date.now()
        });

        updates.guesses=guesses;

        if(guess===target){
            updates.winner=currentPlayer;
        }else{
            updates.turn=other;
        }

        gameRef.update(updates);
        document.getElementById("guessNumber").value="";
    });
}

function updateUI(game){
    if(!currentPlayer) return;

    const other=currentPlayer==="youssef"?"ameni":"youssef";

    const lockSection=document.getElementById("lockSection");
    const waitingSection=document.getElementById("waitingSection");
    const playSection=document.getElementById("playSection");
    const winnerDisplay=document.getElementById("winnerDisplay");

    if(!game[currentPlayer].locked){
        lockSection.classList.remove("hidden");
        waitingSection.classList.add("hidden");
        playSection.classList.add("hidden");
        return;
    }

    if(!game[other].locked){
        lockSection.classList.add("hidden");
        waitingSection.classList.remove("hidden");
        playSection.classList.add("hidden");
        return;
    }

    lockSection.classList.add("hidden");
    waitingSection.classList.add("hidden");
    playSection.classList.remove("hidden");

    document.getElementById("guessTitle").innerHTML=
        currentPlayer==="youssef"?
        "Guess Ameni's number":
        "Guess Youssef's number";

    if(game.winner){
        document.getElementById("turnDisplay").innerHTML="GAME OVER";
        document.getElementById("guessBtn").disabled=true;
        winnerDisplay.innerHTML=game.winner+" WINS!";
        winnerDisplay.classList.remove("hidden");
        return;
    }

    if(game.turn===currentPlayer){
        document.getElementById("turnDisplay").innerHTML="YOUR TURN";
        document.getElementById("guessBtn").disabled=false;
    }else{
        document.getElementById("turnDisplay").innerHTML="WAITING...";
        document.getElementById("guessBtn").disabled=true;
    }
}

function resetGame(){
    gameRef.remove();
    location.reload();
}

</script>

</body>
</html>
