<!DOCTYPE html>
<html>
<head>
<title>Youssef & Ameni Game</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
    font-family:Arial;
    background:linear-gradient(135deg,#667eea,#764ba2);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    padding:15px;
}
.container{
    display:flex;
    gap:15px;
    width:100%;
    max-width:800px;
}
.history{
    width:250px;
    background:white;
    border-radius:15px;
    padding:15px;
    overflow-y:auto;
}
.history h3{
    text-align:center;
    margin-bottom:10px;
}
.history-item{
    padding:8px;
    border-bottom:1px solid #eee;
    font-size:14px;
}
.game-box{
    flex:1;
    background:white;
    border-radius:20px;
    padding:25px;
}
.player-btn{
    width:100%;
    padding:20px;
    margin:10px 0;
    font-size:22px;
    font-weight:bold;
    border:none;
    border-radius:15px;
    cursor:pointer;
    color:white;
}
.youssef{background:#2196F3;}
.ameni{background:#E91E63;}
.section{
    background:#f8f9fa;
    border-radius:15px;
    padding:20px;
    margin:15px 0;
}
input{
    width:100%;
    padding:15px;
    font-size:20px;
    text-align:center;
    border:2px solid #ddd;
    border-radius:10px;
    margin:10px 0;
}
button{
    width:100%;
    padding:15px;
    background:#4CAF50;
    color:white;
    border:none;
    border-radius:10px;
    font-size:18px;
    cursor:pointer;
}
.hidden{display:none;}
.waiting{
    background:#fff3cd;
    padding:15px;
    border-radius:10px;
    text-align:center;
}
.turn-box{
    background:#e8f5e9;
    padding:10px;
    border-radius:10px;
    text-align:center;
    margin:10px 0;
}
</style>
</head>

<body>

<div class="container">

<div class="history">
    <h3>HISTORY</h3>
    <div id="historyList"></div>
</div>

<div class="game-box">

<h1 style="text-align:center;">YOUSSEF VS AMENI</h1>

<div id="playerScreen">
    <div class="section">
        <h3>WHO ARE YOU?</h3>
        <button class="player-btn youssef" onclick="setPlayer('youssef')">YOUSSEF</button>
        <button class="player-btn ameni" onclick="setPlayer('ameni')">AMENI</button>
    </div>
</div>

<div id="gameScreen" class="hidden">

<div id="lockSection" class="section">
    <h3 id="playerName"></h3>
    <p>Choose your secret number (1-100)</p>
    <input type="number" id="secretNumber" min="1" max="100">
    <button onclick="lockNumber()">LOCK NUMBER</button>
</div>

<div id="waitingSection" class="waiting hidden">
    Waiting for other player...
</div>

<div id="playSection" class="hidden">
    <div class="turn-box" id="turnDisplay"></div>

    <div class="section">
        <h3 id="guessTitle"></h3>
        <input type="number" id="guessNumber" min="1" max="100">
        <button onclick="makeGuess()" id="guessBtn" disabled>GUESS</button>
    </div>

    <div id="hintDisplay" class="waiting hidden"></div>
</div>

</div>

<button onclick="resetGame()" style="background:#f44336;margin-top:20px;">
NEW GAME
</button>

</div>
</div>

<script>

const firebaseConfig = {
  apiKey: "AIzaSyCrWG5PZpMSEGhmqoFJofmECCSnN8uMYc",
  authDomain: "youssef-ameni-game.firebaseapp.com",
  databaseURL: "https://youssef-ameni-game-default-rtdb.firebaseio.com",
  projectId: "youssef-ameni-game",
  storageBucket: "youssef-ameni-game.firebasestorage.app",
  messagingSenderId: "238776242009",
  appId: "1:238776242009:web:a34003b6e60f1d1e0ec648"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();
const gameRef = database.ref("games/game123");

let currentPlayer=null;
let winnerAnnounced=false;

gameRef.on("value",(snapshot)=>{
    const game=snapshot.val();
    if(game) updateUI(game);
});

function setPlayer(player){
    currentPlayer=player;
    document.getElementById("playerScreen").classList.add("hidden");
    document.getElementById("gameScreen").classList.remove("hidden");
    document.getElementById("playerName").innerHTML=player.toUpperCase();

    gameRef.once("value",(snap)=>{
        if(!snap.val()){
            gameRef.set({
                youssef:{locked:false,number:null},
                ameni:{locked:false,number:null},
                turn:"youssef",
                winner:null,
                guesses:[]
            });
        }
    });
}

function lockNumber(){
    const num=parseInt(document.getElementById("secretNumber").value);
    if(!num || num<1 || num>100) return alert("Number must be 1-100");

    let updates={};
    updates[currentPlayer+"/locked"]=true;
    updates[currentPlayer+"/number"]=num;
    gameRef.update(updates);
}

function makeGuess(){
    const guess=parseInt(document.getElementById("guessNumber").value);
    if(!guess || guess<1 || guess>100) return alert("Number must be 1-100");

    gameRef.once("value",(snap)=>{
        const game=snap.val();
        if(game.winner) return;

        const other=currentPlayer==="youssef"?"ameni":"youssef";
        const target=game[other].number;

        let guesses=game.guesses||[];
        guesses.push({player:currentPlayer,guess:guess});

        let updates={guesses:guesses};

        if(guess===target){
            updates.winner=currentPlayer;
        }else{
            updates.turn=other;
        }

        gameRef.update(updates);
        document.getElementById("guessNumber").value="";
    });
}

function updateUI(game){
    if(!currentPlayer) return;

    const other=currentPlayer==="youssef"?"ameni":"youssef";

    if(game.winner && !winnerAnnounced){
        winnerAnnounced=true;
        alert(game.winner.toUpperCase()+" WON!");
    }

    document.getElementById("historyList").innerHTML="";
    if(game.guesses){
        game.guesses.forEach(g=>{
            if(g.player===currentPlayer){
                let target=currentPlayer==="youssef"?game.ameni.number:game.youssef.number;
                let result=g.guess<target?"HIGHER":g.guess>target?"LOWER":"CORRECT";
                document.getElementById("historyList").innerHTML +=
                    "<div class='history-item'>"+g.guess+" â†’ "+result+"</div>";
            }
        });
    }

    if(!game[currentPlayer].locked) return;
    if(!game[other].locked) return;

    document.getElementById("playSection").classList.remove("hidden");

    if(game.turn===currentPlayer && !game.winner){
        document.getElementById("turnDisplay").innerHTML="YOUR TURN";
        document.getElementById("guessBtn").disabled=false;
    }else{
        document.getElementById("turnDisplay").innerHTML="WAITING...";
        document.getElementById("guessBtn").disabled=true;
    }
}

function resetGame(){
    winnerAnnounced=false;
    gameRef.remove();
    location.reload();
}

</script>
</body>
</html>
